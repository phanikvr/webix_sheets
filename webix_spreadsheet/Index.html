<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <script src="Scripts/codebase/webix/webix.js"></script>
    
    <script src="Scripts/codebase/spreadsheet.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="Scripts/codebase/webix/webix.css">
    <link rel="stylesheet" type="text/css" href="Scripts/codebase/spreadsheet.css">
</head>
<body>
    <script type="text/javascript">
        var states = {};
        webix.ready(function () {
            var buttons = {
                width: 250,
                type: "space",
                rows: [
					{
					    id: "upl1", 
					    view: "uploader",
					    multiple: false,
					    autosend: false,
                        link: "mylist",
					    accept: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
					    value: "Load from Excel file",
					    on: {
					        onBeforeFileAdd: function (upload) {
					            $$("savebtn").show();
					            $$("savebtn").enable();
					            $$("ss1").reset();
					            $$("ss1").parse(upload.file, "excel");					           
					        }                            
					    },
					    upload: "api/account/UploadSingleFile",
					},
                    {
                        view: "list",
                        id: "mylist",
                        type: "uploader" //defines config of each list item
                    },
					{
					    view: "button", id:"savebtn", hidden:true, label: "Save Excel", click: function () {
					        this.disable();
					        $$("upl1").send(function (response) {
					            if (response)
					                webix.message(response.status);
					            $$("editor").show();
					        });					      
					    }
					},                    
                    {
                        view: "button", id:"editor", label: "Edit Data", hidden:true, click: function () {
                            //var f = $$("upl1").files;
                            //var file_id = f.getFirstId();
                            //webix.send("/data_editor.html", {file:f.getItem(file_id).name.slice(0,-4) + ".csv"}, "GET");
                            webix.send("/data_editor.html", null, "GET");
                        }
                    }
                ]
            };
            webix.ui({
                cols: [buttons, {
                    id: "ss1",
                    view: "spreadsheet",
                    readonly: true
                    //liveEditor: true
                }]
            });          
        });
    </script>
</body>
</html>